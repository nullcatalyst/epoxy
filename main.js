#!/usr/bin/env node
"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}function r(){const e=JSON.parse(n.readFileSync(f,{encoding:"utf8"}));e.sources&&e.outputs||process.exit();let l=o(e.outputs),a=new c({watch:!!e.watch,sources:o(e.sources)});l.map(e=>{const r=new u(a,e.entry,{minify:!!e.minify,file:e.file,data:e.data});return r.on("output",r=>{e.file?s(t.dirname(e.file),(o,t)=>{if(o)return console.error(o);n.writeFile(e.file,r,{encoding:"utf8"},r=>{if(r)return console.error(r);console.log("Output",e.file)})}):(console.log("["+e.entry+"]:"),console.log(r+"\n"))}),r});const p=i.watch(f,{ignoreInitial:!0}).on("change",()=>{p.close(),a.stop(),r()}).on("unlink",()=>{p.close(),a.stop()})}function o(e){return Array.isArray(e)?e:[e]}var n=require("fs"),t=require("path"),i=require("chokidar"),s=e(require("mkdirp"));const{Library:c,Application:u}=require("./lib"),l=process.argv,a=l.length,f=t.resolve(2===a?"epoxy.config.json":l[2]);r();
